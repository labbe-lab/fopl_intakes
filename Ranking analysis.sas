***********RANKING SAMPLE - WILL NEED TO UPDATE NUTRIENT (E.G., SODIUM, SUGAR) AND FOPL CATEGORY (E.G., NO FOP, FOP, EXEMPTED)***;
**********THIS CODE SHOWS FOOD GROUP RANKING FOR FOODS THAT WOULD DISPLAY A FOP SYMBOL FOR SATURATED FAT*****;

LIBNAME INLIB "INSERT FID FILE CATEGORIZED BY FOP FILE";
DATA WORK.FID_WL; SET INLIB.fidfrl_cg2nutr; RUN;

*******RECATEGORIZE FOODS BASED ON THE NEW CATEGORY CREATED FOR ANALYSIS ********;
PROC IMPORT DATAFILE= "INSERT NEW GROUPING EXCEL FILE BASED ON TRA CATEGORY"
DBMS=XLSX REPLACE OUT=GROUP;
GETNAMES=YES;
RUN;

PROC SORT DATA=GROUP; BY TRA_ITEM; RUN;
PROC SORT DATA=FID_WL; BY TRA_ITEM; RUN;

DATA FID_WL; MERGE FID_WL (IN=A) GROUP; BY TRA_ITEM; IF A; RUN;


****CREATING SEPERATE FILES BY WL**;
DATA FID_FAS_WL0 FID_FAS_WL1; SET FID_WL;
IF FOP_SATFAT2=0 THEN OUTPUT FID_FAS_WL0;
IF FOP_SATFAT2=1 THEN OUTPUT FID_FAS_WL1; RUN;
DATA FID_FAS_WL2; SET FID_WL_FAS;
IF FOP_SATFAT2=2 THEN OUTPUT FID_FAS_WL2; RUN;


PROC SORT DATA=FID_FAS_WL1; BY TRA_MOD; RUN;

%MACRO TRA (NAME=);
DATA FID_FAS_WL1; SET FID_FAS_WL1;

TRA&NAME._FAS=0;
IF TRA_MOD IN ("&NAME.") THEN TRA&NAME._FAS = FID_FAS;

RUN;
%MEND;

%TRA (NAME=A100);

%TRA (NAME=A200);
%TRA (NAME=A300);
%TRA (NAME=A400);
%TRA (NAME=A500);

%TRA (NAME=B100);
%TRA (NAME=B200);
%TRA (NAME=B300);
%TRA (NAME=B400);
%TRA (NAME=B500);
%TRA (NAME=B600);
%TRA (NAME=B700);
%TRA (NAME=B800);

%TRA (NAME=C100);
%TRA (NAME=C200);
%TRA (NAME=C300);
%TRA (NAME=C400);
%TRA (NAME=C500);
%TRA (NAME=C600);

%TRA (NAME=D100);
%TRA (NAME=D200);
%TRA (NAME=D300);
%TRA (NAME=D400);
%TRA (NAME=D500);

%TRA (NAME=E100);
%TRA (NAME=E200);
%TRA (NAME=E300);

%TRA (NAME=G100);

%TRA (NAME=H100);
%TRA (NAME=H200);
%TRA (NAME=H300);

%TRA (NAME=I100);
%TRA (NAME=I200);

%TRA (NAME=J100);
%TRA (NAME=J200);

%TRA (NAME=K100);
%TRA (NAME=K200);

%TRA (NAME=L100); 
%TRA (NAME=L200);
%TRA (NAME=L300);
%TRA (NAME=L400);

%TRA (NAME=M100);
%TRA (NAME=M200);
%TRA (NAME=M300);
%TRA (NAME=M400);
%TRA (NAME=M500);
%TRA (NAME=M600);
%TRA (NAME=M700);
%TRA (NAME=M800);
%TRA (NAME=M900);
%TRA (NAME=M1000);

%TRA (NAME=N100);
%TRA (NAME=N200);
%TRA (NAME=N300);
%TRA (NAME=N400);

%TRA (NAME=R100);
%TRA (NAME=R200);
%TRA (NAME=R300);

%TRA (NAME=S100);
%TRA (NAME=S200);
%TRA (NAME=S300);

%TRA (NAME=V100);
%TRA (NAME=V200);
%TRA (NAME=V300);

%TRA (NAME=W100);


/*NOW TRANSPOSE TO MAKE ONE ROW/PERSON DATASET, JUST LIKE HS_NCI*/
PROC SORT DATA=FID_FAS_WL1; BY ADM_RNO; RUN;

** SUMMING UP ON IND LEVEL**; 
DATA FASTRAA100SUM; SET FID_FAS_WL1 (KEEP=ADM_RNO TRAA100_FAS); 
BY ADM_RNO; IF FIRST.ADM_RNO THEN TRAA100_FAS_SUM=.;
TRAA100_FAS_SUM + TRAA100_FAS; IF LAST.ADM_RNO THEN OUTPUT; RUN;
DATA FASTRAA100SUM; SET FASTRAA100SUM (DROP = TRAA100_FAS); RUN;

%MACRO TRANSPOSE (NAME=);
DATA FASTRA&NAME.SUM; SET FID_FAS_WL1 (KEEP=ADM_RNO TRA&NAME._FAS); 
BY ADM_RNO; IF FIRST.ADM_RNO THEN TRA&NAME._FAS_SUM=.;
TRA&NAME._FAS_SUM + TRA&NAME._FAS; IF LAST.ADM_RNO THEN OUTPUT; RUN;
DATA FASTRA&NAME.SUM; SET FASTRA&NAME.SUM (DROP = TRA&NAME._FAS); RUN;

%MEND;

/*%TRANSPOSE (NAME=A-E);*/
%TRANSPOSE (NAME=A100);
%TRANSPOSE (NAME=A200);
%TRANSPOSE (NAME=A300);
%TRANSPOSE (NAME=A400);
%TRANSPOSE (NAME=A500);

%TRANSPOSE (NAME=B100);
%TRANSPOSE (NAME=B200);
%TRANSPOSE (NAME=B300);
%TRANSPOSE (NAME=B400);
%TRANSPOSE (NAME=B500);
%TRANSPOSE (NAME=B600);
%TRANSPOSE (NAME=B700);
%TRANSPOSE (NAME=B800);

%TRANSPOSE (NAME=C100);
%TRANSPOSE (NAME=C200);
%TRANSPOSE (NAME=C300);
%TRANSPOSE (NAME=C400);
%TRANSPOSE (NAME=C500);
%TRANSPOSE (NAME=C600);

%TRANSPOSE (NAME=D100);
%TRANSPOSE (NAME=D200);
%TRANSPOSE (NAME=D300);
%TRANSPOSE (NAME=D400);
%TRANSPOSE (NAME=D500);

%TRANSPOSE (NAME=E100);
%TRANSPOSE (NAME=E200);
%TRANSPOSE (NAME=E300);


DATA TRAATOE; MERGE FASTRAA100SUM FASTRAA200SUM FASTRAA300SUM FASTRAA400SUM FASTRAA500SUM 
FASTRAB100SUM FASTRAB200SUM FASTRAB300SUM FASTRAB400SUM FASTRAB500SUM FASTRAB600SUM FASTRAB700SUM
FASTRAB800SUM FASTRAC100SUM FASTRAC200SUM FASTRAC300SUM FASTRAC400SUM FASTRAC500SUM FASTRAC600SUM FASTRAD100SUM FASTRAD200SUM 
FASTRAD300SUM FASTRAD400SUM FASTRAD500SUM FASTRAE100SUM FASTRAE200SUM FASTRAE300SUM; RUN;

PROC DATASETS NOPRINT; DELETE FASTRAA100SUM FASTRAA200SUM FASTRAA300SUM FASTRAA400SUM FASTRAA500SUM 
FASTRAB100SUM FASTRAB200SUM FASTRAB300SUM FASTRAB400SUM FASTRAB500SUM FASTRAB600SUM FASTRAB700SUM
FASTRAB800SUM FASTRAC100SUM FASTRAC200SUM FASTRAC300SUM FASTRAC400SUM FASTRAC500SUM FASTRAC600SUM FASTRAD100SUM FASTRAD200SUM 
FASTRAD300SUM FASTRAD400SUM FASTRAD500SUM FASTRAE100SUM FASTRAE200SUM FASTRAE300SUM; RUN;

%TRANSPOSE (NAME=G100);
%TRANSPOSE (NAME=H100);
%TRANSPOSE (NAME=H200);
%TRANSPOSE (NAME=H300);
%TRANSPOSE (NAME=I100);
%TRANSPOSE (NAME=I200);
%TRANSPOSE (NAME=J100);
%TRANSPOSE (NAME=J200);
%TRANSPOSE (NAME=K100);
%TRANSPOSE (NAME=K200);
%TRANSPOSE (NAME=L100); 
%TRANSPOSE (NAME=L200);
%TRANSPOSE (NAME=L300);
%TRANSPOSE (NAME=L400);
%TRANSPOSE (NAME=M100);
%TRANSPOSE (NAME=M200);
%TRANSPOSE (NAME=M300);
%TRANSPOSE (NAME=M400);
%TRANSPOSE (NAME=M500);
%TRANSPOSE (NAME=M600);
%TRANSPOSE (NAME=M700);
%TRANSPOSE (NAME=M800);
%TRANSPOSE (NAME=M900);
%TRANSPOSE (NAME=M1000);

%TRANSPOSE (NAME=N100);
%TRANSPOSE (NAME=N200);
%TRANSPOSE (NAME=N300);
%TRANSPOSE (NAME=N400);
%TRANSPOSE (NAME=R100);
%TRANSPOSE (NAME=R200);
%TRANSPOSE (NAME=R300);
%TRANSPOSE (NAME=S100);
%TRANSPOSE (NAME=S200);
%TRANSPOSE (NAME=S300);
%TRANSPOSE (NAME=V100);
%TRANSPOSE (NAME=V200);
%TRANSPOSE (NAME=V300);
%TRANSPOSE (NAME=W100);

DATA TRAGTOW; MERGE FASTRAG100SUM FASTRAH100SUM FASTRAH200SUM FASTRAH300SUM FASTRAI100SUM FASTRAI200SUM FASTRAJ100SUM FASTRAJ200SUM FASTRAK100SUM FASTRAK200SUM  
FASTRAL100SUM FASTRAL200SUM FASTRAL300SUM FASTRAL400SUM FASTRAM100SUM FASTRAM200SUM FASTRAM300SUM FASTRAM400SUM FASTRAM500SUM 
FASTRAM600SUM FASTRAM700SUM FASTRAM800SUM FASTRAM900SUM FASTRAM1000SUM FASTRAN100SUM FASTRAN200SUM FASTRAN300SUM FASTRAN400SUM FASTRAR100SUM 
FASTRAR200SUM FASTRAR300SUM FASTRAS100SUM FASTRAS200SUM FASTRAS300SUM FASTRAV100SUM FASTRAV200SUM FASTRAV300SUM FASTRAW100SUM; RUN;

PROC DATASETS NOPRINT; DELETE FASTRAG100SUM FASTRAH100SUM FASTRAH200SUM FASTRAH300SUM FASTRAI100SUM FASTRAI200SUM FASTRAJ100SUM FASTRAJ200SUM FASTRAK100SUM FASTRAK200SUM  
FASTRAL100SUM FASTRAL200SUM FASTRAL300SUM FASTRAL400SUM FASTRAM100SUM FASTRAM200SUM FASTRAM300SUM FASTRAM400SUM FASTRAM500SUM 
FASTRAM600SUM FASTRAM700SUM FASTRAM800SUM FASTRAM900SUM FASTRAM1000SUM FASTRAN100SUM FASTRAN200SUM FASTRAN300SUM FASTRAN400SUM FASTRAR100SUM 
FASTRAR200SUM FASTRAR300SUM FASTRAS100SUM FASTRAS200SUM FASTRAS300SUM FASTRAV100SUM FASTRAV200SUM FASTRAV300SUM FASTRAW100SUM; RUN;

/*MERGE ALL DATASETS INTO ONE FINAL TRA_MOD DATASET*/
DATA TRA_ALL_FAS_WL1; MERGE TRAATOE TRAGTOW; RUN;



*****************************************;
****BRING IN EERFINAL FROM NUTR INTAKE ANALYSIS ***;
LIBNAME INLIB "INSERT INTAKE FILE";
DATA WORK.EERFINAL_ADULTS_COPY; SET INLIB.eer_cg2nutr; RUN;

PROC SORT DATA=EERFINAL_ADULTS_COPY; BY ADM_RNO; RUN;_
PROC SORT DATA=TRA_ALL_FAS_WL1; BY ADM_RNO; RUN;
DATA TRA_FAS_WL1; MERGE TRA_ALL_FAS_WL1 (IN=A) EERFINAL_ADULTS_COPY; BY ADM_RNO; IF A; RUN;

**RANKING**;
%MACRO RANK (SAMPLE=, NAME=, NUTRIENT1=);

*SUM NUTRIENT INTAKE FOR EACH TRA_MOD CATEGORY*;
PROC SUMMARY DATA=&SAMPLE.;
VAR TRA&NAME._&NUTRIENT1._SUM;
OUTPUT OUT=TRA&NAME. SUM=TRA&NAME._&NUTRIENT1._TOTAL; 
WEIGHT WTS_P; RUN;
DATA TRA&NAME.; SET TRA&NAME. (DROP=_TYPE_ _FREQ_); RUN;

*AND SUM TOTAL NUTRIENT INTAKE*;
PROC SUMMARY DATA=&SAMPLE.; VAR FSDD&NUTRIENT1.; WEIGHT WTS_P;
OUTPUT OUT=HS_NUTRIENTS SUM=&NUTRIENT1._TOTAL; RUN;
DATA HS_NUTRIENTS; SET HS_NUTRIENTS (DROP=_TYPE_ _FREQ_); RUN;

*NOW MAKE POPULATION RATIO*;
DATA &SAMPLE._RATIO_TRA&NAME.; IF _N_=1 THEN SET TRA&NAME.;
SET HS_NUTRIENTS;
TRA&NAME._&NUTRIENT1._RANK=TRA&NAME._&NUTRIENT1._TOTAL/&NUTRIENT1._TOTAL;RUN;

DATA &SAMPLE._RATIO_TRA&NAME.; SET &SAMPLE._RATIO_TRA&NAME.
(KEEP=TRA&NAME._&NUTRIENT1._RANK); RUN;

PROC DATASETS NOPRINT; DELETE TRA&NAME. HS_NUTRIENTS; RUN;
%MEND;

%RANK (SAMPLE=TRA_FAS_WL1, NAME=A100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=A200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=A300, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=A400, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=A500, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=B100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=B200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=B300, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=B400, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=B500, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=B600, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=B700, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=B800, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=C100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=C200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=C300, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=C400, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=C500, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=C600, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=D100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=D200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=D300, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=D400, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=D500, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=E100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=E200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=E300, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=G100, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=H100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=H200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=H300, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=I100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=I200, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=J100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=J200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=K100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=K200, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=L100, NUTRIENT1=FAS); 
%RANK (SAMPLE=TRA_FAS_WL1, NAME=L200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=L300, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=L400, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=M100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=M200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=M300, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=M400, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=M500, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=M600, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=M700, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=M800, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=M900, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=M1000, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=N100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=N200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=N300, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=N400, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=R100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=R200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=R300, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=S100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=S200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=S300, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=V100, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=V200, NUTRIENT1=FAS);
%RANK (SAMPLE=TRA_FAS_WL1, NAME=V300, NUTRIENT1=FAS);

%RANK (SAMPLE=TRA_FAS_WL1, NAME=W100, NUTRIENT1=FAS);

DATA TRA_FAS_WL1_RATIO; MERGE TRA_FAS_WL1_RATIO_TRAA100 TRA_FAS_WL1_RATIO_TRAA200 TRA_FAS_WL1_RATIO_TRAA300 
TRA_FAS_WL1_RATIO_TRAA400 TRA_FAS_WL1_RATIO_TRAA500 TRA_FAS_WL1_RATIO_TRAB100 TRA_FAS_WL1_RATIO_TRAB200 
TRA_FAS_WL1_RATIO_TRAB300 TRA_FAS_WL1_RATIO_TRAB400 TRA_FAS_WL1_RATIO_TRAB500 TRA_FAS_WL1_RATIO_TRAB600 
TRA_FAS_WL1_RATIO_TRAB700 TRA_FAS_WL1_RATIO_TRAB800 TRA_FAS_WL1_RATIO_TRAC100 TRA_FAS_WL1_RATIO_TRAC200 
TRA_FAS_WL1_RATIO_TRAC300 TRA_FAS_WL1_RATIO_TRAC400 TRA_FAS_WL1_RATIO_TRAC500 TRA_FAS_WL1_RATIO_TRAC600 
TRA_FAS_WL1_RATIO_TRAD100 TRA_FAS_WL1_RATIO_TRAD200 TRA_FAS_WL1_RATIO_TRAD300 TRA_FAS_WL1_RATIO_TRAD400 
TRA_FAS_WL1_RATIO_TRAD500 TRA_FAS_WL1_RATIO_TRAE100 TRA_FAS_WL1_RATIO_TRAE200 TRA_FAS_WL1_RATIO_TRAE300 
TRA_FAS_WL1_RATIO_TRAG100 TRA_FAS_WL1_RATIO_TRAH100 TRA_FAS_WL1_RATIO_TRAH200 TRA_FAS_WL1_RATIO_TRAH300 
TRA_FAS_WL1_RATIO_TRAI100 TRA_FAS_WL1_RATIO_TRAI200 TRA_FAS_WL1_RATIO_TRAJ100 TRA_FAS_WL1_RATIO_TRAJ200 
TRA_FAS_WL1_RATIO_TRAK100 TRA_FAS_WL1_RATIO_TRAK200 TRA_FAS_WL1_RATIO_TRAL100 TRA_FAS_WL1_RATIO_TRAL200 TRA_FAS_WL1_RATIO_TRAL300 
TRA_FAS_WL1_RATIO_TRAL400 TRA_FAS_WL1_RATIO_TRAM100 TRA_FAS_WL1_RATIO_TRAM200 TRA_FAS_WL1_RATIO_TRAM300 
TRA_FAS_WL1_RATIO_TRAM400 TRA_FAS_WL1_RATIO_TRAM500 TRA_FAS_WL1_RATIO_TRAM600 TRA_FAS_WL1_RATIO_TRAM700 
TRA_FAS_WL1_RATIO_TRAM800 TRA_FAS_WL1_RATIO_TRAM900 TRA_FAS_WL1_RATIO_TRAM1000 TRA_FAS_WL1_RATIO_TRAN100 TRA_FAS_WL1_RATIO_TRAN200 
TRA_FAS_WL1_RATIO_TRAN300 TRA_FAS_WL1_RATIO_TRAN400 TRA_FAS_WL1_RATIO_TRAR100 TRA_FAS_WL1_RATIO_TRAR200 
TRA_FAS_WL1_RATIO_TRAR300 TRA_FAS_WL1_RATIO_TRAS100 TRA_FAS_WL1_RATIO_TRAS200 TRA_FAS_WL1_RATIO_TRAS300 
TRA_FAS_WL1_RATIO_TRAV100 TRA_FAS_WL1_RATIO_TRAV200 TRA_FAS_WL1_RATIO_TRAV300 TRA_FAS_WL1_RATIO_TRAW100; RUN;
						
PROC DATASETS NOPRINT; DELETE TRA_FAS_WL1_RATIO_TRAA100 TRA_FAS_WL1_RATIO_TRAA200 TRA_FAS_WL1_RATIO_TRAA300 
TRA_FAS_WL1_RATIO_TRAA400 TRA_FAS_WL1_RATIO_TRAA500 TRA_FAS_WL1_RATIO_TRAB100 TRA_FAS_WL1_RATIO_TRAB200 
TRA_FAS_WL1_RATIO_TRAB300 TRA_FAS_WL1_RATIO_TRAB400 TRA_FAS_WL1_RATIO_TRAB500 TRA_FAS_WL1_RATIO_TRAB600 
TRA_FAS_WL1_RATIO_TRAB700 TRA_FAS_WL1_RATIO_TRAB800 TRA_FAS_WL1_RATIO_TRAC100 TRA_FAS_WL1_RATIO_TRAC200 
TRA_FAS_WL1_RATIO_TRAC300 TRA_FAS_WL1_RATIO_TRAC400 TRA_FAS_WL1_RATIO_TRAC500 TRA_FAS_WL1_RATIO_TRAC600 
TRA_FAS_WL1_RATIO_TRAD100 TRA_FAS_WL1_RATIO_TRAD200 TRA_FAS_WL1_RATIO_TRAD300 TRA_FAS_WL1_RATIO_TRAD400 
TRA_FAS_WL1_RATIO_TRAD500 TRA_FAS_WL1_RATIO_TRAE100 TRA_FAS_WL1_RATIO_TRAE200 TRA_FAS_WL1_RATIO_TRAE300 
TRA_FAS_WL1_RATIO_TRAG100 TRA_FAS_WL1_RATIO_TRAH100 TRA_FAS_WL1_RATIO_TRAH200 TRA_FAS_WL1_RATIO_TRAH300 
TRA_FAS_WL1_RATIO_TRAI100 TRA_FAS_WL1_RATIO_TRAI200 TRA_FAS_WL1_RATIO_TRAJ100 TRA_FAS_WL1_RATIO_TRAJ200 
TRA_FAS_WL1_RATIO_TRAK100 TRA_FAS_WL1_RATIO_TRAK200 TRA_FAS_WL1_RATIO_TRAL100 TRA_FAS_WL1_RATIO_TRAL200 TRA_FAS_WL1_RATIO_TRAL300 
TRA_FAS_WL1_RATIO_TRAL400 TRA_FAS_WL1_RATIO_TRAM100 TRA_FAS_WL1_RATIO_TRAM200 TRA_FAS_WL1_RATIO_TRAM300 
TRA_FAS_WL1_RATIO_TRAM400 TRA_FAS_WL1_RATIO_TRAM500 TRA_FAS_WL1_RATIO_TRAM600 TRA_FAS_WL1_RATIO_TRAM700 
TRA_FAS_WL1_RATIO_TRAM800 TRA_FAS_WL1_RATIO_TRAM900 TRA_FAS_WL1_RATIO_TRAM1000 TRA_FAS_WL1_RATIO_TRAN100 TRA_FAS_WL1_RATIO_TRAN200 
TRA_FAS_WL1_RATIO_TRAN300 TRA_FAS_WL1_RATIO_TRAN400 TRA_FAS_WL1_RATIO_TRAR100 TRA_FAS_WL1_RATIO_TRAR200 
TRA_FAS_WL1_RATIO_TRAR300 TRA_FAS_WL1_RATIO_TRAS100 TRA_FAS_WL1_RATIO_TRAS200 TRA_FAS_WL1_RATIO_TRAS300 
TRA_FAS_WL1_RATIO_TRAV100 TRA_FAS_WL1_RATIO_TRAV200 TRA_FAS_WL1_RATIO_TRAV300 TRA_FAS_WL1_RATIO_TRAW100; RUN;


**EXCEL OUTPUT**;
PROC EXPORT DATA=TRA_FAS_WL1_RATIO
DBMS=XLSX OUTFILE="INSERT DIRECTORY AND FILE NAME TO EXPORT DATA";
RUN;

